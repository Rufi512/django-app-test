{%extends 'index.html'%}
{%load static%}
{%block extra_head%}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
<!-- CSS flickity -->
<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
<!-- JavaScript flickity -->
<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>

<style>
    .section-general{
        position: relative;
        background: white;
        border-radius: 6px;
        padding:20px;
        box-shadow: 1px 2px 0px #9d9c9c33;
        overflow: hidden;
    }

    .banner-image{
        width:100%;
        height:320px;
        object-fit:cover;
    }

    .section-general::after,
    .section-general::before{
        content: "";
        position: absolute;
        right: -5px;
        top: -5px;
        border-radius: 3px;
        background: #131e51;
        width: 24px;
        height: 24px;

    }


    .section-general .title-section{
            padding: 0 0px;
            font-size: 22px;
            color: #131e51;
            font-weight: 600;
            padding-bottom: 10px;
            border-bottom: 2px solid #374177;
    }

    .section-general .card-price{
            color: #047f04;
            font-size: 22px;
            font-weight: 600;
    }

    .section-carousel{
        padding:0;
    }

    .section-carousel::after,
    .section-carousel::before{
        display:none;
    }

    .no-results{
        display: flex;
       justify-content: center;
        align-items: center;
      flex-direction: column;
    }

    .card{
        max-width:235px;
        box-shadow: 0px 2px 11px 4px #e1e1e1;
        color:black;
        text-decoration: none;
    }

    .card .card-title{
        font-weight:600;
        transition:all 0.3s ease;
        font-size: 18px;
        color: #131e51;
        font-weight: 600;
    }

    .card:hover .card-title{
        color:#252e59;
    }

    .card p{
        font-size:16px;
        color:#333333;
    }

    .card .card-img-top{
        height: 235px;
        padding: 20px;
        object-fit: cover;
    }

    .container-categories{
        align-items: stretch;
    }

    #items-all{
        margin: auto;
        max-width: 1400px;
    }

    .card-text{
        height: auto;
    }

    #items-all .info-head{
        display: flex;
        flex-flow: wrap;
        justify-content: space-between; 
        margin:8px 0;
    }

    #items-all .info-head h6{
        margin: 0;
    }

    .loader{
        margin-top: 10px;
        display: flex;
        justify-content: center;
        padding: 20px 0;
        opacity: 0;
        transform: translateY(50px);
        visibility: hidden;
        transition: all 0.3s ease;
    }

    .loader-show{
        opacity: 1 !important;
        transform: translateY(0px) !important;
        visibility: visible !important;
    }

    .loader i{
        font-size: 1.5em;
        animation: rotate 0.8s infinite linear;
    }

    .section-products .card{
        box-shadow:none;
        background-color: transparent;
    }

    /* position dots in carousel */
    .flickity-page-dots {
        bottom: 0px;
    }

    /* white circles */
    .flickity-page-dots .dot {
        width: 12px;
        height: 12px;
        opacity: 1;
        background: transparent;
        border: 2px solid white;
        }
/* fill-in selected dot */
.flickity-page-dots .dot.is-selected {
  background: white;
}

.carousel-cell {
  width: 100%;
  height: 320px;
  margin-right: 10px;
  background: #8C8;
  border-radius: 5px;
  counter-increment: gallery-cell;
}

    @keyframes rotate{
        from{
            transform: rotate(0deg);
        }
        to{
            transform: rotate(360deg);
        }
    }


</style>
{%endblock extra_head%}
{%block content%}
{%csrf_token%}

<!-- Section banners -->
<section style="margin-top: 20px;" class="container-fluid">
    <div class="section-carousel section-general carousel" data-flickity>

                <a class="carousel-cell banner" href="#">
                      <img class="banner-image" src="/static/img/1.jpg" alt="Card image cap">
                    </a>

                 <a class="carousel-cell banner" href="#">
                      <img class="banner-image" src="/static/img/2.jpg" alt="Card image cap">
                    </a>

                <a class="carousel-cell banner" href="#">
                      <img class="banner-image" src="/static/img/3.jpg" alt="Card image cap">
                    </a>
    </div>

</section>

<!-- Section categories products -->
<section style="margin-top: 20px;" class="container-fluid">
    <div class="section-categories section-general">
        <h2 class="title-section">Encuentra lo que necesitas</h2>
        <div class="d-flex flex-wrap justify-content-center gap-4 col-12 p-3 container-categories">
            {% for elm in categories %}

                <a class="card" href="#">
                      <img class="card-img-top" src="/media/{{elm.image}}" alt="Card image cap">
                      <div class="card-body" >
                        <h5 class="card-title">{{elm.title}}</h5>
                        <p class="card-text">{{elm.description}}</p>
                      </div>
                    </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Section products -->
<section style="margin-top: 20px;" class="container-fluid">
    <div class="section-products section-general">
        <h2 class="title-section">Lo que tenemos para ti</h2>
        <div class="d-flex flex-wrap justify-content-center gap-4 col-12 p-3 container-categories">
            {% for elm in products %}

                <a class="card" href="#">
                      <img class="card-img-top" src="/media/{{elm.image}}" alt="Card image cap">
                      <div class="card-body" >
                        <h5 class="card-title">{{elm.title}}</h5>
                        <p class="card-text card-price">${{elm.price|floatformat:"0"}}</p>
                      </div>
                    </a>
            {% endfor %}
        </div>
    </div>
</section>


{%endblock content%}

{%block extra_js%}
<script>
var modal = document.getElementById('modal')
var product_to_delete = null
var nameProduct = document.getElementById("name-item")
var nextPage = null
var scrollLoad = false
const viewList = document.getElementById("items-all")
const loader = document.getElementById("loader")

const Nothing = () => {
    alert("I have lied")
}


const Erase = (id, title, index) => {
    product_to_delete = {id, title, index}
    nameProduct.innerHTML = `Are you sure to delete: <span style="font-weight:bold">${title}</span>?`
    modal.style.visibility = "visible"
}

const hiddenModal = () => {
    modal.style.visibility = "hidden"
    setTimeout(() => {
        nameProduct.innerHTML = ''
        product_to_delete = null
    }, 300)

}

const modify = (id) => {
    window.location.href = `/modify/product/${id}`
}





window.addEventListener("load", () => {
    getData('/api/products')
})

window.addEventListener("scroll",(e)=>{
    let windowScroll = document.body.offsetHeight - window.innerHeight
    let scrollUser = windowScroll - e.target.scrollingElement.scrollTop
    if(scrollUser <= 50 && scrollLoad === false && nextPage){
        scrollLoad = true
        loader.classList.add('loader-show')
        getData(nextPage)
    }
})
</script>


{%endblock extra_js%}